<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0"> <!-- displays site properly based on user's device -->

  <link rel="icon" type="image/png" sizes="32x32" href="./images/favicon-32x32.png">
  <link rel="stylesheet" href="./style.css">
  <title>Frontend Mentor | Calculator app</title>

</head>
<body data-theme="dark">
  <div class="container">
      <div class="theme-container">1 2 3</div>
      <div class="header">
        <span id="calc-text">calc</span> 
        <div class="stick-to-end">THEME</div>
        <div class="btn-holder">
          <div class="btn-circle"></div>
        </div>
      </div>
      <div class="calculation-container"> <div class="screen"></div></div>
      <div class="grid">

        <button class="button-style-1">7</button>
        <button class="button-style-1">8</button>
        <button class="button-style-1">9</button>
        <button class="blue-button">DEL</button>
        <button class="button-style-1">4</button>
        <button class="button-style-1">5</button>
        <button class="button-style-1">6</button>
        <button class="plus-button">+</button>
        <button class="button-style-1">1</button>
        <button class="button-style-1">2</button>
        <button class="button-style-1">3</button>
        <button class="button-style-1 minus-button">-</button>
        <button class="button-style-1 decimal-button">.</button>
        <button class="button-style-1">0</button>
        <button class="button-style-1 divide-button">/</button>
        <button class="button-style-1 multiply-button">x</button>
        <button class="blue-button last-group-button ">RESET</button>
        <button class="button-style-1 last-group-button orange-button">=</button>


      </div>
  </div>

  <script>

    // theme toggle button
    var btn = document.querySelector('.btn-circle');
    var body = document.querySelector("body")

    
    let state = 0;
    btn.addEventListener('click', function() {

      switch(state) {
        // light theme
        case 0:
          btn.classList.add('active');
          body.setAttribute('data-theme', 'light');
          state += 1
          break;
        // dark theme
        case 1:
          btn.classList.add('active-2');
          body.setAttribute('data-theme', 'third-theme');
          state += 1;
          break;
        // default theme
        default:
          state = 0;
          btn.classList.remove('active-2')
          btn.classList.remove('active')
          body.setAttribute('data-theme', "dark")
      }
    })

    // calculator variables such as all the buttons and the screen displaying the calculations
    var calBtns = document.querySelectorAll('.grid')
    var screen = document.querySelector('.screen')

    var stack = []
    
    // handle keypress from keyboard and validates if it is a key on the calculator
    function checkValidKey(char) {
      const keyCode = char.charCodeAt(0)
      if (48 <= keyCode && keyCode <= 57) { return true }
      if (keyCode === 61 | keyCode === 43) { return true}
      switch (keyCode) {
        case 61:
          return true;
          break;
        case 95:
          return true;
          break;
        case 47:
          return true;
          break;
        case 120:
          return true;
          break;
        case 42:
          return true;
          break;
        case 45:
          return true;
          break;
        case 66:
          return true;
          break;
        case 69:
          return true;
          break;
      }

      return false
    }
    
    // listens for a keypress
    body.addEventListener('keydown', function(e) {
      const isValidKey = checkValidKey(e.key)
      
      if (isValidKey) {
        let key = e.key
          switch(key) {
            case "x":
              key = "*"
            case "Backspace":
              key = false
              stack.pop()
            case "=":
              key = false
              screen.innerText = eval(stack.join(''))
              stack = []
            case "Enter":
              key = false
              screen.innerText = eval(stack.join(''))
              stack = []
          }
          key ? stack.push(key) : {}
          key ? screen.innerText = stack.join('') : {}

          console.log(stack)
      }

    })


    // listens to which button is pressed on the calculator
    calBtns.forEach(function(element) {
      element.addEventListener('click', function(e) {
        const value = e.target.innerText

        switch(value) {
          case "=":
            try {
              screen.innerText = eval(stack.join(''))
            } catch (error) {
              screen.innerText = "ERROR"
            }
            stack = []
            break;
          case "RESET":
            stack = []
            screen.innerText = ""
            break;
          case "DEL":
            stack.pop()
            screen.innerText = stack.join('')
            break;
          case "x":
            stack.push("*")
            screen.innerText = stack.join('')
            break;
          default:
            stack.push(value)
            screen.innerText = stack.join('')
            break;

        }

      })
    })






  </script>
</body>
<footer class="attribution">
  Challenge by <a href="https://www.frontendmentor.io?ref=challenge" target="_blank">Frontend Mentor</a>.
  Coded by <a href="#">defunSM</a>.
</footer>
</html>
